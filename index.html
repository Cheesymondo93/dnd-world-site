<!doctype html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Enter the Lich’s Domain</title>
  <link rel="stylesheet" href="css/styles.css?v=6" />
</head>
<body class="splash">
  <div class="splash-wrap">
    <img src="assets/lich.png?v=7" alt="Lich reaching out" class="lich" draggable="false" />
    <!-- dark overlay + spotlight -->
    <div class="veil" aria-hidden="true"></div>

    <button id="enter" type="button">Enter</button>
  </div>

  <script>
    // Spotlight follows the button while pressed; darkness returns when released
    const body = document.body;
    const btn  = document.getElementById('enter');

    function setSpot(x, y, intensity){ // intensity: 0..1 (1 = brightest)
      document.documentElement.style.setProperty('--lx', x + 'px');
      document.documentElement.style.setProperty('--ly', y + 'px');
      document.documentElement.style.setProperty('--lintensity', intensity);
    }

    function updateFromButton(intensity=1){
      const r = btn.getBoundingClientRect();
      setSpot(r.left + r.width/2, r.top + r.height/2 + window.scrollY, intensity);
    }

    // Press → brighten; move → keep spotlight on the button; release → dark
    const onDown = () => { updateFromButton(1); body.classList.add('lit'); };
    const onMove = () => { if (body.classList.contains('lit')) updateFromButton(1); };
    const onUp   = () => { body.classList.remove('lit'); setSpot(0,0,0); };

    btn.addEventListener('pointerdown', onDown);
    window.addEventListener('pointermove', onMove);
    window.addEventListener('pointerup', onUp);
    window.addEventListener('pointercancel', onUp);

    // Whoosh → go to map
    btn.addEventListener('click', () => {
      body.classList.add('whoosh');
      setTimeout(() => window.location.href = 'map.html', 400);
    });

    // Initial state: pitch black
    setSpot(0,0,0);
  </script>
</body>
</html>
